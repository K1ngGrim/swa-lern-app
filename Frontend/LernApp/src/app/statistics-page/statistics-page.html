<main class="page-content">
  <div class="content-container">
    <h1>{{ 'STATISTICS.TITLE' | translate }}</h1>

    @if (isLoading()) {
      <div class="loading">
        {{ 'STATISTICS.LOADING' | translate }}
      </div>
    }

    @if (error() && !isLoading()) {
      <div class="alert alert-error">
        {{ error() | translate }}
      </div>
    }

    @if (!isLoading() && !error()) {
      <!-- Stats Cards -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value">{{ decks().length }}</div>
          <div class="stat-label">{{ 'STATISTICS.TOTAL_DECKS' | translate }}</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">{{ totalCards() }}</div>
          <div class="stat-label">{{ 'STATISTICS.TOTAL_CARDS' | translate }}</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">{{ getStudiedToday() }}</div>
          <div class="stat-label">{{ 'STATISTICS.STUDIED_TODAY' | translate }}</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">{{ getStudiedThisWeek() }}</div>
          <div class="stat-label">{{ 'STATISTICS.STUDIED_THIS_WEEK' | translate }}</div>
        </div>
      </div>

      <!-- Empty State -->
      @if (deckStats().length === 0) {
        <div class="empty-state">
          <p>{{ 'STATISTICS.NO_DECKS' | translate }}</p>
        </div>
      }

      <!-- Deck Breakdown -->
      @if (deckStats().length > 0) {
        <div class="deck-breakdown">
          <h2>{{ 'STATISTICS.DECK_BREAKDOWN' | translate }}</h2>
          <div class="breakdown-list">
            @for (stat of deckStats(); track stat.deck.deckId) {
              <div class="breakdown-item">
                <div class="deck-info">
                  <h3 class="deck-name">{{ stat.deck.name }}</h3>
                  <div class="deck-meta">
                    <span class="card-count">{{ stat.cardCount }} {{ stat.cardCount === 1 ? 'card' : 'cards' }}</span>
                    @if (stat.lastLearned) {
                      <span class="last-studied">
                        {{ 'STATISTICS.LAST_STUDIED' | translate: { days: getDaysAgo(stat.lastLearned) } }}
                      </span>
                    } @else {
                      <span class="last-studied">{{ 'STATISTICS.NEVER_STUDIED' | translate }}</span>
                    }
                  </div>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" [style.width.%]="(stat.cardCount / (totalCards() || 1)) * 100"></div>
                </div>
              </div>
            }
          </div>
        </div>
      }
    }
  </div>
</main>
