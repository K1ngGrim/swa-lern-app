<main class="page-content">
  <div class="content-container">
    @if (deck()) {
      <h1>{{ deck()?.name }}</h1>
    } @else {
      <h1>{{ 'DECK_LEARN.TITLE' | translate }}</h1>
    }

    <!-- Loading / Error / Empty States -->
    @if (isLoading()) {
      <p class="status">
        {{ 'DECK_LEARN.LOADING' | translate }}
      </p>
    }
    @if (!isLoading() && error()) {
      <p class="status error">
        {{ error() | translate }}
      </p>
    }

    @if (!isLoading() && !error()) {
      @if (!sessionCompleted()) {
        @if (currentCard) {
          <div class="card-container" (click)="onCardClick()">
            <div class="card-inner" [class.flipped]="showBack()">
              <p class="card-text face front" [class.visible]="!showBack()">
                {{ currentCard.front }}
              </p>
              <p class="card-text face back" [class.visible]="showBack()">
                {{ currentCard.back }}
              </p>
            </div>
          </div>

          <div class="ratings" [class.visible]="showBack()">
            <button class="rating-btn again" (click)="rateCard(0)" [disabled]="isSubmittingRating()">
              {{ 'DECK_LEARN.RATING_AGAIN' | translate }}
            </button>
            <button class="rating-btn hard" (click)="rateCard(1)" [disabled]="isSubmittingRating()">
              {{ 'DECK_LEARN.RATING_HARD' | translate }}
            </button>
            <button class="rating-btn good" (click)="rateCard(2)" [disabled]="isSubmittingRating()">
              {{ 'DECK_LEARN.RATING_GOOD' | translate }}
            </button>
            <button class="rating-btn easy" (click)="rateCard(3)" [disabled]="isSubmittingRating()">
              {{ 'DECK_LEARN.RATING_EASY' | translate }}
            </button>
          </div>

          @if (session()?.cards?.length) {
            <p class="progress">
              {{ 'DECK_LEARN.PROGRESS' | translate: { current: currentIndex() + 1, total: session()?.cards?.length } }}
            </p>
          }
        } @else {
          <p class="placeholder">{{ 'DECK_LEARN.NO_CARDS' | translate }}</p>
        }
      } @else {
        <div class="complete-state">
          <h2>{{ 'DECK_LEARN.COMPLETED_TITLE' | translate }}</h2>
          <p>{{ 'DECK_LEARN.COMPLETED_MESSAGE' | translate }}</p>
          <div class="complete-actions">
            <button class="secondary-btn" (click)="goToDeck()">
              {{ 'DECK_LEARN.BACK_TO_DECK' | translate }}
            </button>
            <button class="primary-btn" (click)="restartSession()">
              {{ 'DECK_LEARN.RESTART' | translate }}
            </button>
          </div>
        </div>
      }
    }
  </div>
</main>
